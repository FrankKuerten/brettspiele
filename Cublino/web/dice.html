<html>
	<head>
		<title>3D</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script type="text/javascript" src="../../web/js/three.min.js"></script>
		<script type="text/javascript" src="../../web/js/Detector.js"></script>
		<script type="text/javascript" src="../../web/js/CanvasRenderer.js"></script>
		<script type="text/javascript" src="../../web/js/Projector.js"></script>
		<script type="text/javascript" src="../../web/js/OrbitControls.js"></script>
		<script type="text/javascript" src="../../web/js/THREEx.KeyboardState.js"></script>
		<script type="text/javascript" src="../../web/js/THREEx.WindowResize.js"></script>
		<script type="text/javascript" src="../../web/js/ThreeCSG.js"></script>
		<script>
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

			var loader = new THREE.TextureLoader();
			var diceTextur = loader.load( 'kiefer.jpg' );
			diceTextur.minFilter = THREE.NearestFilter;
			var diceMat = new THREE.MeshLambertMaterial( { map: diceTextur } );
			var boxGeo = new THREE.BoxGeometry( 1, 1, 1 );
			var ballGeo = new THREE.SphereGeometry(.7, 40, 40);
			var ballBSP = new ThreeBSP(new THREE.Mesh( ballGeo ));
			var boxBSP = new ThreeBSP(new THREE.Mesh( boxGeo ));
			var mulde = new THREE.SphereGeometry(.1, 4, 4);
			var diceBSP = ballBSP.intersect( boxBSP );
			// Eins
			diceBSP = stanze( mulde.translate(-0.5, 0, 0), diceBSP );
			// Sechs
			diceBSP = stanze( mulde.translate(1, 0, 0.25), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0, -0.5), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0.3, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0, -0.6, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0, 0.5), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0.6, 0), diceBSP );
			// Drei
			mulde.center();
			diceBSP = stanze( mulde.translate(0, -0.5, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0.25, 0, 0.25), diceBSP );
			diceBSP = stanze( mulde.translate(-0.5, 0, -0.5), diceBSP );
			// Vier
			mulde.center();
			diceBSP = stanze( mulde.translate(0.25, 0.5, 0.25), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0, -0.5), diceBSP );
			diceBSP = stanze( mulde.translate(-0.5, 0, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0, 0.5), diceBSP );
			// FÃ¼nf
			mulde.center();
			diceBSP = stanze( mulde.translate(0, 0, -0.5), diceBSP );
			diceBSP = stanze( mulde.translate(0.25, 0.25, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0, -0.5, 0), diceBSP );
			diceBSP = stanze( mulde.translate(-0.5, 0, 0), diceBSP );
			diceBSP = stanze( mulde.translate(0, 0.5, 0), diceBSP );
			// Zwei
			mulde.center();
			diceBSP = stanze( mulde.translate(0.25, 0.25, 0.5), diceBSP );
			diceBSP = stanze( mulde.translate(-0.5, -0.5, 0), diceBSP );
			mulde.dispose();
			var dice = diceBSP.toMesh( diceMat );
			dice.position.set(-2, 0, 0);
			scene.add( dice );

			var dice2Textur = loader.load( 'zebrano.jpg' );
			dice2Textur.minFilter = THREE.NearestFilter;
			var dice2Mat = new THREE.MeshLambertMaterial( { map: dice2Textur } );
			var dice2 = diceBSP.toMesh( dice2Mat );
			dice2.position.set(2, 0, 0);
			scene.add(dice2);

			// var light = new THREE.HemisphereLight( { skyColorHex: 0x404040, groundColorHex: 0x202020, intensity: 0.3 } ); // soft white light
			var light = new THREE.PointLight(0xffffff);
			light.position.set(0,250,0);
			scene.add( light );
			
			var ambLight = new THREE.AmbientLight(0x707070);
			scene.add(ambLight);

			camera.position.z = 5;

			var render = function () {
				requestAnimationFrame( render );

				dice.rotation.x += 0.02;
				dice.rotation.y += 0.04;

				dice2.rotation.x -= 0.03;
				dice2.rotation.y += 0.03;

				renderer.render(scene, camera);
			};

			render();
			
			function stanze(mulde, wuerfel){
				var muldeBSP = new ThreeBSP(new THREE.Mesh( mulde ));
				return wuerfel.subtract( muldeBSP );
			}
		</script>
	</body>
</html>